
# 📦 LINE断捨離Bot プロジェクト報告書

作成者：Tetsuya Hino  
作成日：2025年7月17日

---

## 1. 🎯 プロジェクト概要

本プロジェクトは、LINEの未読通知が溜まりがちな公式アカウントやチャットを「削除候補」として提案し、ユーザーが整理・削除の判断を行えるようサポートする**断捨離支援Bot**の開発です。

目的は、LINE通知の断捨離に伴う心理的負担を軽減し、「残す / 削除 / 非表示」を選ぶ判断を支援するUXを提供することでした。

---

## 2. 🛠 使用技術

- Python（FastAPI）
- LINE Messaging API
- Ngrok（開発時トンネル公開）
- Googleスプレッドシート（今後連携予定）
- GitHub（コード管理）
- dotenv / logging / requests 等

---

## 3. 🚧 実装した機能

- LINE Webhookの受信＆署名検証
- LINE BotからFlex Messageで削除候補提案
- 選択肢（削除候補 / 非表示 / 残す）に応じた返信
- `.env`による安全な環境変数管理
- Ngrokでのローカルサーバー公開＆Webhook接続
- Gitによるバージョン管理、リファクタリング対応
- READMEテンプレートと作業記録の整理

---

## 4. 🧪 解決した課題

### ✅ Webhook署名検証エラー
- `.env`にBOM混入、キー名崩れ、旧環境変数が残存していた
- FastAPIのログ出力・ngrokのトラフィック監視により切り分け
- エンコーディング修正、strip処理、utils.pyへの抽出で解決

### ✅ push_messageの応答検証
- LINEからのイベントが届いていない状態を `ngrok http` の UI で可視化し特定
- Webhook URLの更新漏れや起動順の問題を修正

### ✅ PowerShellでのGit操作
- `&&` ではなく `;` 区切りでコマンドを実行することで解決

---

## 5. 🔁 反省点と学び

| 課題 | 対応 | 学び |
|------|------|------|
| Webhook署名のエラーで数時間ロス | `.env`再保存・キー修正・旧環境変数削除 | 環境変数とBOMの落とし穴を体験で理解 |
| LINE Botがトークを削除できない仕様 | 削除提案Botとして目的を再設計 | API仕様に応じて“役割”を定義し直す重要性 |
| スプレッドシート連携は未実装 | 構想段階で一時保留 | MVP完成後に次のステップとして切り出す判断が重要 |
| 開発後のWebhook再起動忘れで動かないことあり | ログで原因特定し改善 | ローカルBotでは**再起動の癖付け**が必要 |

---

## 6. 📈 成果

- Webhookが安定的に200 OKを返す構成を確立
- FastAPIコードをKISS/DRY原則に沿って整理し、可読性と保守性を向上
- GitHubにREADME・作業記録・構成ファイルを整備
- LINE Botが通知に対し適切にFlex Messageで提案・応答
- note・X向けのアウトプット資材も作成（QRコード付き画像含む）

---

## 7. 🚀 次のステップ

- [ ] Googleスプレッドシートへの削除候補記録の実装
- [ ] リマインダー通知（例：「3日経った候補を再通知」）
- [ ] スプレッドシートから「削除を促す」ボタン操作（GAS活用）
- [ ] `pytest` による署名検証ロジックの単体テスト導入
- [ ] CIで `.env.example` 構文チェック、Linter連携

---

## 8. 🔗 リンク集

- GitHub: https://github.com/euro0707/-PriceBotX
- note記事: https://note.com/sns_brain
- X（旧Twitter）: https://x.com/sns_brain
- ポートフォリオ: https://euro0707.github.io/myportfolio-project-/

---

**開発完了：2025年7月17日（MVP）**

引き続き、より実用的な通知整理体験の提供に向けてアップデートを続けていきます。

— Tetsuya Hino
